from __future__ import absolute_import
from __future__ import print_function
import numpy as np
np.random.seed(1337) # for reproducibility
import h5py
import copy
from keras.utils import np_utils
from sklearn import metrics
from sklearn.cross_validation import KFold
from sklearn.preprocessing import StandardScaler
from sklearn.svm.libsvm import predict_proba
from sklearn import svm
from sklearn import preprocessing
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier
from sklearn.covariance import EllipticEnvelope
from sklearn.tree import DecisionTreeClassifier
from scipy import stats

def shuffle(X, y, seed=1337):
    np.random.seed(seed)
    shuffle = np.arange(len(y))
    np.random.shuffle(shuffle)
    X = X[shuffle]
    y = y[shuffle]
    return X, y

nb_classes = 5

print('Loading Data...')
# the data, shuffled and split between tran and test sets
h5f=h5py.File('train_data.h5','r+')
X_train=h5f['dataset'][:]
h5f.close()

h5f=h5py.File('train_labels.h5','r+')
Y_train=h5f['dataset'][:]
h5f.close()
#print(X_train[0,:])

print('Data Loaded!')

print('Preprocessing...')
minmax_scale = preprocessing.MinMaxScaler(feature_range=(-1000, 1000))
X_train=minmax_scale.fit_transform(X_train)

h5f=h5py.File('test_data.h5','r+')
X_test=h5f['dataset'][:]
h5f.close()

print('Preprocessing...')
X_test=minmax_scale.transform(X_test)
#X_test=scaler.transform(X_test)
print(X_test.shape, 'test samples')

no_values=[1494, 3, 64, 11, 2604, 7945, 2, 3, 2, 20, 5, 2, 15, 2, 3, 14, 9, 2, 5, 1, 1, 2, 451, 414, 83, 42, 69, 41, 95, 74, 61, 255, 255, 101, 101, 101, 63, 89, 54, 101, 101, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 249999, 250000]
red_stared_idx = [56193, 65537, 117842, 155653, 6, 16391, 72364, 161111, 163854, 106511, 147472, 193880, 40978, 188437, 57367, 24600, 32793, 185220, 40317, 8221, 131103, 180256, 237601, 122915, 24612, 57350, 180264, 143212, 155690, 53255, 226138, 90157, 16433, 80563, 8250, 204859, 81980, 188477, 62, 8255, 180288, 65602, 65603, 172100, 131141, 213063, 57417, 169673, 213069, 241502, 147536, 81, 65618, 237653, 57430, 32856, 54628, 213082, 53263, 8285, 180319, 204898, 163939, 32869, 24679, 196713, 90218, 8302, 102297, 172145, 229491, 98420, 150206, 16502, 131192, 32889, 32891, 115496, 155773, 90238, 142174, 24706, 16516, 138305, 131208, 239284, 69564, 155789, 24718, 172176, 31427, 16532, 149, 213143, 114840, 219753, 41115, 180380, 106653, 106654, 196893, 123044, 189809, 16553, 196778, 147627, 111785, 163869, 16561, 204979, 237752, 229561, 139451, 49342, 106693, 8225, 213192, 16587, 147662, 23245, 139472, 180434, 155859, 90325, 54649, 106712, 172251, 98525, 32991, 213216, 57572, 82154, 110631, 205036, 196845, 114926, 139503, 196848, 153039, 172281, 196861, 65790, 237823, 16640, 193920, 49410, 57604, 73989, 204969, 164104, 120033, 24845, 49422, 74000, 123154, 131347, 180501, 147736, 205081, 123165, 49439, 188705, 57635, 180516, 16677, 155943, 164137, 33066, 8491, 180524, 41263, 164144, 8498, 147770, 187103, 316, 213310, 188736, 215776, 211417, 57671, 328, 188745, 172363, 144334, 164178, 145176, 74069, 57686, 343, 90458, 90459, 122938, 229726, 211685, 147808, 354, 24931, 49509, 106397, 74091, 131436, 65901, 196974, 151613, 179503, 90482, 202144, 229748, 82297, 231835, 97002, 188799, 188800, 75158, 156038, 168001, 93839, 147849, 237962, 153578, 143426, 16782, 65935, 24977, 82322, 241153, 154350, 8600, 32836, 229787, 8261, 32202, 12289, 57765, 180646, 125494, 429, 65966, 25008, 33202, 435, 437, 77897, 172472, 188780, 165279, 25022, 172479, 139713, 221634, 147907, 25028, 221637, 238022, 98761, 221642, 204602, 238028, 218530, 49615, 213456, 139729, 156116, 188886, 206244, 16858, 90587, 485, 55391, 41451, 494, 83368, 16882, 74228, 115190, 202153, 66041, 506, 74238, 188930, 75179, 156164, 197126, 16903, 156169, 98828, 16909, 123407, 528, 131601, 15107, 205334, 16922, 66075, 16924, 199429, 238112, 546, 16931, 148004, 16933, 25126, 57895, 218517, 107049, 41514, 66093, 211720, 164403, 25141, 44755, 90679, 115256, 75188, 82490, 98879, 138047, 43787, 180805, 139848, 8778, 1463, 236301, 57937, 115283, 222883, 142095, 8796, 139869, 49253, 213604, 66150, 221800, 164459, 221805, 229999, 181421, 197234, 170492, 205433, 8827, 151658, 41598, 66178, 49795, 8837, 205446, 82567, 86124, 64279, 186332, 234946, 49807, 657, 156306, 107156, 125229, 11262, 168056, 668, 179513, 98976, 155760, 106953, 238243, 98982, 123559, 58024, 76572, 123593, 25259, 172719, 58032, 107185, 107187, 90804, 205493, 164534, 156345, 160692, 189117, 106613, 82625, 58051, 49861, 153962, 8905, 143479, 180941, 140749, 156369, 25298, 107219, 41687, 82650, 130687, 732, 17118, 66272, 33505, 140003, 197348, 221929, 230122, 66283, 8943, 179243, 230867, 99061, 31529, 90873, 153329, 205564, 154693, 164607, 140487, 17153, 74498, 103894, 115466, 161239, 25362, 181013, 49944, 165878, 133417, 221983, 197409, 9691, 238361, 35633, 189224, 123689, 9005, 172239, 237704, 238387, 123701, 80692, 148283, 225104, 66368, 9026, 238403, 131909, 838, 28670, 156490, 41803, 58188, 9039, 41809, 238418, 17236, 41818, 115548, 25438, 142288, 156512, 155792, 115554, 82787, 107364, 58213, 9062, 50025, 230250, 41835, 170813, 57491, 160619, 50037, 107382, 230264, 32916, 105829, 33661, 131966, 217237, 82817, 230274, 82819, 212399, 162881, 54764, 9098, 140513, 237720, 164754, 223712, 118611, 149708, 189336, 58863, 924, 164765, 107424, 58274, 151707, 41892, 140197, 9126, 26097, 115624, 91049, 197546, 940, 942, 148403, 25524, 148406, 132023, 180587, 91065, 205754, 33723, 150346, 197566, 74688, 33733, 189382, 148423, 74696, 132042, 82891, 82892, 197589, 50137, 148443, 25565, 37404, 9185, 176796, 136699, 58341, 33766, 25576, 74230, 115691, 107503, 50161, 82930, 192618, 107511, 115707, 197628, 238591, 123904, 164865, 96599, 195414, 94380, 205835, 214029, 115726, 136153, 66579, 164884, 33814, 113785, 148504, 186618, 17436, 107550, 1057, 107555, 156709, 42022, 184497, 123944, 181289, 135881, 17452, 53228, 105464, 211442, 133699, 123955, 148533, 99382, 189495, 86196, 115774, 184501, 25664, 42050, 143247, 205894, 51865, 74825, 1099, 83021, 22029, 132176, 50260, 243214, 90055, 17498, 214107, 222300, 33887, 83040, 42081, 156770, 99428, 9318, 66663, 222312, 176255, 25712, 181367, 93353, 140411, 42109, 1152, 140417, 230532, 156805, 222345, 237517, 91275, 140429, 99471, 173592, 74899, 66708, 191805, 235723, 83097, 156889, 33949, 56778, 162672, 1191, 207627, 181788, 33963, 173228, 230573, 156847, 9393, 156850, 15219, 132277, 230582, 156855, 35700, 74938, 22047, 83134, 115903, 222401, 165061, 58567, 42187, 124108, 1231, 124114, 50723, 148693, 115926, 26148, 66778, 131279, 9436, 91359, 17633, 180255, 50405, 66793, 206058, 83179, 17644, 50414, 154493, 230641, 34034, 206068, 68478, 25846, 91383, 83192, 169713, 139707, 206078, 156927, 66816, 17666, 91395, 124164, 238853, 50438, 124167, 27356, 42254, 98259, 83217, 9490, 1299, 17687, 91416, 188536, 189723, 222492, 9501, 58656, 9505, 189733, 91431, 58664, 83246, 102621, 144346, 50481, 194527, 120371, 83252, 42294, 116024, 206137, 34106, 83259, 124220, 75069, 173378, 75075, 173381, 124230, 148809, 185537, 42317, 1358, 134029, 25937, 173395, 1365, 222550, 202450, 222554, 91486, 110821, 9568, 181601, 58722, 181605, 25958, 17771, 240913, 107885, 124270, 50543, 124273, 104522, 128574, 17782, 83319, 116088, 189817, 116092, 143594, 34178, 196723, 17796, 162710, 232473, 88983, 198029, 9614, 26000, 83345, 1427, 173460, 165270, 214425, 107930, 148891, 50588, 80794, 198047, 58784, 56219, 1444, 12529, 165288, 189865, 99911, 132524, 26029, 148912, 222641, 159987, 9652, 173494, 83383, 50616, 58811, 17852, 181722, 140741, 203272, 183482, 91594, 1483, 99789, 148944, 198097, 228109, 230868, 164805, 50646, 75226, 58843, 42461, 198110, 17887, 50665, 42474, 132588, 50670, 45309, 184963, 132350, 58963, 17908, 205054, 75254, 7081, 17915, 148989, 91647, 50692, 132613, 174617, 108039, 149003, 108046, 69351, 83472, 83475, 75284, 149013, 42519, 99864, 189978, 108059, 17948, 140890, 34335, 214560, 91681, 124450, 1627, 132644, 149030, 108075, 42540, 149037, 173614, 108959, 58933, 214583, 26171, 50748, 83517, 42558, 1599, 83521, 147723, 108103, 176396, 173666, 67150, 190031, 230992, 91731, 169179, 165466, 75355, 173661, 142675, 133172, 222816, 42593, 140898, 140899, 18020, 173671, 1640, 113596, 9834, 9837, 83567, 190056, 188691, 157301, 50807, 27442, 108153, 165500, 155114, 237845, 18051, 132743, 34440, 9865, 1674, 239244, 83598, 75407, 176408, 57613, 91800, 231066, 181915, 190108, 75421, 9887, 26272, 100003, 193732, 173734, 26279, 59048, 215282, 50858, 166855, 181935, 211912, 149171, 9908, 58978, 165558, 207099, 116408, 116409, 125898, 173758, 30325, 91840, 91843, 89047, 116422, 215283, 173768, 15308, 26315, 206541, 18126, 91856, 116344, 18131, 198356, 42709, 206550, 18135, 1752, 33060, 81893, 18140, 1758, 1760, 173793, 103716, 239336, 83689, 190186, 83691, 1773, 231151, 91888, 173810, 26356, 75513, 136831, 34561, 94507, 108292, 83717, 75526, 211739, 9994, 48087, 190221, 157454, 86317, 75537, 50962, 124692, 50966, 214807, 149273, 67354, 83740, 125914, 124704, 91938, 1829, 101050, 182056, 223017, 173866, 79495, 223020, 18221, 100143, 173872, 223025, 214836, 18229, 190264, 34617, 199647, 100156, 133725, 51008, 10053, 1862, 51019, 75596, 1870, 116561, 218561, 116563, 75604, 59223, 239448, 206683, 18268, 74805, 100190, 75616, 67425, 190307, 190308, 75621, 59238, 18280, 141163, 223084, 186002, 132975, 26480, 182129, 223090, 92020, 34677, 170985, 198520, 67220, 51067, 190334, 177702, 108424, 214921, 231306, 67467, 10125, 56803, 28000, 100242, 90901, 190359, 214936, 223129, 1946, 10139, 83870, 59295, 214945, 116379, 116644, 51109, 214951, 214897, 116650, 182187, 31730, 51119, 140495, 108465, 52211, 176283, 133045, 29001, 26552, 158708, 206778, 165819, 59324, 214975, 141249, 223170, 67523, 42948, 1989, 51144, 206794, 187383, 51148, 119117, 198608, 165841, 157650, 140963, 167446, 206808, 239577, 223194, 2011, 100316, 108509, 174046, 141279, 92813, 108513, 199675, 110422, 80538, 239591, 182248, 141290, 100332, 123218, 229759, 121853, 149488, 10229, 100342, 67575, 10236, 10237, 180565, 190464, 10241, 187197, 2054, 209838, 67592, 198667, 82557, 18445, 203999, 83983, 10256, 26642, 133139, 141332, 190485, 198678, 182296, 206876, 165917, 183301, 43040, 190499, 223268, 18470, 59057, 34856, 157739, 51249, 34866, 215091, 26676, 45406, 67639, 26681, 92218, 100411, 92223, 67648, 180576, 116802, 14006, 100423, 133196, 215117, 26702, 125009, 41315, 67668, 18517, 59479, 67673, 59485, 149600, 3088, 240137, 108644, 34917, 149608, 182379, 157804, 231533, 215150, 231101, 67696, 100465, 127675, 213115, 215157, 135529, 157816, 141433, 26746, 2173, 18559, 92288, 186110, 84099, 116869, 69632, 198791, 141448, 106860, 2190, 149647, 47537, 116882, 133267, 108692, 49518, 67734, 125977, 207001, 159864, 231579, 107381, 92320, 34980, 63174, 10408, 10410, 239787, 182446, 75953, 229747, 18121, 100536, 18617, 149690, 10427, 10428, 108733, 51390, 215231, 35008, 225120, 2242, 59587, 100549, 18631, 133350, 92362, 190667, 157900, 84173, 43214, 59600, 18641, 174290, 219665, 10453, 133334, 172409, 149723, 149732, 26854, 92391, 223464, 35879, 67821, 26864, 35058, 91859, 144698, 35063, 18681, 84219, 92412, 198910, 124629, 10496, 18690, 11307, 157957, 76040, 26889, 26892, 84237, 76046, 117007, 157968, 50904, 100626, 207124, 121902, 67289, 10521, 190748, 59677, 141600, 47269, 223523, 76068, 130097, 125225, 182571, 157997, 10542, 149807, 223537, 10546, 183347, 141620, 9950, 117046, 26935, 18744, 84282, 100667, 149821, 76094, 195637, 100672, 174401, 207170, 84294, 108871, 238917, 158026, 120546, 228408, 198994, 43347, 239956, 59737, 76122, 237967, 125276, 237415, 2401, 35171, 100708, 210057, 180625, 146837, 108905, 108906, 26987, 84333, 59758, 30440, 26994, 129805, 133493, 67958, 18809, 10618, 231803, 27005, 130112, 141702, 117127, 199048, 136940, 18826, 84363, 27021, 192393, 106904, 59794, 125332, 10720, 190871, 169711, 10652, 76190, 60094, 219399, 240035, 225946, 59815, 108972, 66914, 181686, 216136, 117170, 210494, 207286, 35255, 197850, 1780, 100794, 172447, 92604, 215485, 10686, 199104, 78240, 215490, 240067, 223685, 117194, 125388, 10703, 27090, 174547, 68052, 35285, 158167, 73735, 86436, 223708, 33189, 18912, 117840, 223714, 243451, 10725, 10727, 199145, 125419, 133613, 117230, 117231, 109040, 109044, 95998, 207350, 27128, 51706, 199163, 131058, 84480, 125441, 217515, 199172, 84487, 223752, 100873, 43532, 207373, 231950, 164269, 92688, 27153, 25006, 236633, 35353, 35354, 117928, 150046, 35359, 240160, 117281, 232347, 35364, 5894, 2602, 68140, 238002, 240177, 141874, 29107, 109110, 5897, 100920, 174649, 43578, 35388, 207421, 174654, 158273, 27202, 100107, 133700, 133702, 92743, 27208, 59979, 10829, 35408, 166481, 16182, 133717, 142409, 100956, 109149, 92768, 115131, 199268, 10853, 215654, 151210, 158312, 127420, 158315, 125548, 136978, 19055, 43632, 142440, 84595, 117364, 41406, 68215, 125561, 182907, 130752, 141949, 84606, 207488, 51841, 117380, 60037, 232070, 41409, 117384, 27273, 35466, 101003, 240269, 51856, 223889, 205251, 92820, 35478, 154485, 113331, 150169, 223899, 213003, 125599, 35488, 27297, 215714, 207523, 158372, 51878, 195697, 84648, 10012, 43692, 51886, 63261, 84659, 240308, 158389, 4553, 85108, 215738, 101051, 191164, 35517, 191166, 19136, 149280, 111114, 234210, 117445, 185311, 35527, 240330, 191180, 83746, 114115, 51919, 69106, 51923, 240342, 40057, 174808, 92889, 158427, 76508, 43741, 34597, 207584, 150651, 76518, 166631, 60137, 158443, 117484, 135634, 207599, 173310, 76531, 2805, 109302, 43768, 133884, 2819, 183044, 19205, 92934, 76552, 166665, 68362, 11019, 240398, 231213, 130179, 135641, 138372, 35610, 125723, 11036, 101149, 68382, 35617, 11043, 224038, 92967, 125737, 60203, 52012, 215853, 117550, 130758, 27441, 207666, 27444, 127454, 84790, 150327, 27448, 174906, 11070, 42805, 2882, 19269, 152856, 125770, 150351, 224080, 215889, 19282, 52051, 185440, 172495, 239417, 101208, 2907, 76637, 84830, 224097, 133991, 35688, 207139, 68460, 133997, 142190, 52079, 35697, 141126, 2937, 166780, 27518, 171157, 68482, 240519, 68488, 76682, 60299, 19341, 134030, 60304, 89240, 101267, 207766, 43930, 2971, 11166, 43936, 35746, 134051, 190278, 84902, 139761, 101288, 166825, 183213, 208029, 199136, 76723, 35764, 2997, 117688, 68539, 93118, 76736, 52162, 161611, 3013, 76742, 101319, 52168, 27594, 240588, 113826, 125904, 175057, 68564, 224213, 68842, 43994, 92847, 175071, 60387, 216039, 153923, 134311, 224238, 108669, 3057, 191474, 19443, 84980, 172542, 60407, 162953, 199673, 120399, 142331, 19454, 216063, 232448, 109569, 207875, 19460, 27653, 207880, 76809, 199691, 11276, 76813, 166927, 150544, 194392, 68627, 183317, 175126, 74244, 183324, 213756, 175136, 109601, 3108, 68645, 158759, 30556, 207914, 3115, 224300, 76845, 166962, 27699, 11318, 41481, 109625, 134203, 207932, 93245, 52287, 158786, 215234, 27717, 117830, 82212, 11336, 16908, 93258, 44109, 175182, 52304, 60498, 180929, 27732, 142422, 199767, 158809, 14017, 199771, 240732, 117853, 93278, 3167, 85090, 19557, 199783, 35944, 19561, 117869, 27758, 126064, 116584, 68724, 93302, 158840, 3195, 172232, 18110, 27777, 216194, 182123, 27780, 109701, 236609, 134279, 158856, 3213, 199825, 183442, 216211, 11412, 183445, 19609, 25114, 35998, 150687, 122314, 93348, 117927, 3240, 191657, 3242, 60589, 141431, 183477, 54392, 150714, 60603, 158909, 101567, 175296, 19650, 93387, 231701, 232645, 117958, 150730, 208075, 142543, 101585, 142546, 11478, 27863, 198695, 77019, 240862, 68832, 117989, 150758, 126186, 90663, 240877, 77038, 175343, 143912, 118002, 20044, 158965, 29225, 3320, 239578, 175355, 162482, 118014, 101631, 199937, 158980, 75126, 175366, 240904, 77066, 150743, 36108, 240909, 101646, 167184, 90675, 142611, 11540, 68886, 3351, 85272, 11545, 19739, 78673, 232735, 93472, 3361, 204335, 68902, 167212, 36141, 77103, 77105, 52530, 109875, 183604, 232757, 44342, 52536, 191801, 77114, 31967, 175421, 208191, 11584, 175426, 10123, 216388, 27973, 193243, 171233, 142669, 126286, 167248, 41528, 3411, 44375, 11610, 142683, 27996, 216414, 142687, 109920, 28004, 52582, 36199, 216426, 224372, 150893, 150894, 179567, 134513, 44403, 60789, 68985, 162000, 126332, 44413, 232831, 242240, 216450, 150915, 133233, 159112, 83863, 36237, 28046, 118159, 137559, 205379, 11502, 69014, 100249, 145236, 101785, 28058, 200094, 85408, 77219, 150948, 109993, 93611, 208300, 93620, 169886, 150966, 118199, 77240, 36084, 52667, 186973, 60867, 208325, 118214, 44489, 167372, 178790, 19918, 12877, 3536, 28113, 60884, 67495, 118231, 44504, 112548, 197199, 85468, 19706, 3550, 92069, 134624, 36321, 206069, 75679, 225873, 208360, 19947, 77295, 11762, 107091, 39945, 151029, 60918, 151031, 20032, 69113, 59306, 224766, 110079, 159551, 44545, 151042, 241156, 220137, 28175, 93714, 12395, 175637, 28182, 85528, 128055, 28187, 60956, 126213, 154145, 28193, 148059, 11815, 11816, 20009, 64775, 93740, 183854, 77359, 183560, 20019, 134713, 64225, 208527, 118335, 192064, 44609, 224836, 77382, 134730, 36428, 70242, 52814, 216655, 3664, 128952, 167506, 20051, 69204, 56590, 233046, 175703, 126552, 175705, 101978, 61020, 142242, 101985, 28258, 20067, 3685, 175718, 3687, 216680, 67516, 222986, 61038, 197224, 151156, 228251, 110198, 200312, 85626, 77435, 20092, 69245, 69247, 238187, 159365, 241286, 44679, 208521, 3722, 6125, 42946, 20111, 20113, 236081, 224918, 134807, 120803, 69275, 238817, 232731, 36522, 233131, 20144, 141256, 175796, 130334, 143030, 118456, 159419, 36540, 227274, 186956, 77503, 44741, 143047, 22476, 93898, 200396, 20173, 85711, 151251, 192212, 11989, 61142, 208599, 118488, 241369, 208602, 160202, 52959, 36576, 26576, 82507, 52966, 85735, 159465, 214534, 159467, 3820, 143997, 21677, 12018, 74366, 184054, 216823, 110328, 96147, 233215, 236903, 134919, 77577, 69386, 184075, 85772, 12045, 69390, 134928, 51160, 73234, 143123, 115630, 110357, 12054, 77591, 110361, 77594, 233243, 208668, 116698, 102175, 33681, 53026, 229707, 143140, 189062, 20262, 3881, 96221, 69426, 61236, 42974, 151350, 36665, 102203, 235541, 167742, 118591, 77639, 77640, 192331, 159564, 44877, 62093, 69456, 88035, 115194, 138553, 118616, 200353, 233306, 9917, 77662, 61279, 154253, 3937, 3938, 28515, 167780, 36709, 238225, 175978, 44908, 192365, 187951, 3953, 118645, 104425, 28536, 149071, 44351, 94076, 151421, 77696, 175804, 28548, 184197, 12166, 143239, 36744, 208777, 85898, 36747, 166336, 36751, 3985, 208789, 53143, 53144, 135065, 208794, 120815, 143260, 53149, 23877, 135075, 118694, 94516, 23047, 33436, 110506, 130375, 159660, 241582, 61361, 159668, 187721, 69561, 126907, 126908, 173989, 151493, 225225, 62114, 208846, 20431, 12240, 179534, 159702, 77783, 61400, 155621, 202965, 225245, 200670, 159712, 4067, 217060, 53225, 198775, 61419, 85996, 5864, 167919, 20464, 151537, 41326, 77811, 200692, 162987, 160532, 28663, 77816, 77819, 12285, 159742, 36864, 45057, 233474, 102404, 22529, 77832, 94219, 45036, 126990, 94223, 241681, 135188, 198177, 82607, 233503, 225312, 225968, 4130, 94244, 36901, 94246, 167975, 232796, 138109, 69676, 159792, 143411, 4149, 69686, 94265, 110651, 200764, 20541, 36926, 41653, 151617, 77890, 192581, 28742, 94281, 53323, 176206, 178189, 103096, 94292, 229523, 4184, 176217, 165903, 241756, 201143, 208990, 159839, 36960, 82844, 33692, 167271, 61548, 61550, 45167, 61557, 94327, 86136, 61561, 176250, 12412, 162446, 153621, 135296, 94337, 110722, 42800, 32329, 17326, 176266, 238280, 37005, 184463, 12432, 45201, 37011, 184468, 168085, 61591, 94363, 20637, 209055, 77984, 241825, 59881, 20644, 168102, 45223, 176296, 135340, 184543, 20656, 86193, 110770, 89459, 61620, 86197, 102583, 45242, 45244, 173905, 200053, 200896, 217803, 45254, 241863, 225482, 159948, 159950, 86224, 53458, 12499, 208433, 53462, 12505, 119002, 78043, 176348, 28893, 176350, 86239, 37093, 37098, 135403, 217326, 101757, 135409, 74451, 168724, 28920, 241916, 28925, 61694, 69889, 45318, 163201, 86281, 61706, 148183, 94476, 12558, 94479, 94480, 151826, 45333, 48428, 37144, 102684, 37149, 143647, 12578, 127267, 241959, 201000, 163207, 71730, 28980, 168935, 201017, 184634, 94524, 53566, 69953, 156385, 176456, 225609, 10295, 241997, 209231, 86353, 94547, 4436, 94549, 51257, 4441, 195983, 148453, 29022, 195733, 110945, 4450, 135524, 152294, 127334, 184679, 4456, 20841, 129773, 60574, 176496, 143729, 209266, 201080, 242041, 26687, 746, 77205, 43072, 20866, 176515, 94598, 192904, 29065, 4490, 176523, 168332, 127375, 160145, 240471, 45459, 151956, 242070, 53655, 20888, 168345, 53658, 61851, 4512, 201456, 176547, 94628, 45478, 70056, 12715, 94962, 212381, 37298, 143795, 209332, 20919, 60163, 135609, 4538, 37308, 235594, 86466, 70084, 37318, 29128, 217545, 29130, 61899, 160204, 135630, 79949, 192976, 20946, 150947, 217561, 135643, 45534, 61801, 78305, 20962, 108447, 12776, 49240, 160236, 111086, 220561, 102897, 19881, 143865, 119291, 184830, 30805, 203649, 61953, 218637, 232875, 61958, 231695, 129998, 160266, 133207, 160269, 163245, 135697, 70163, 70165, 127511, 135704, 154549, 183464, 12828, 234014, 86563, 209444, 89900, 29224, 217641, 111149, 135728, 21256, 135732, 185097, 111160, 62009, 127546, 193083, 53820, 119360, 29249, 217666, 54027, 152132, 70213, 4678, 53831, 86600, 86601, 193098, 167351, 135756, 127565, 21070, 184911, 130546, 193108, 193110, 86615, 45658, 21083, 78429, 62050, 200123, 99995, 94822, 53866, 185497, 189202, 168560, 63592, 184946, 201334, 12920, 152185, 4730, 201339, 37501, 62078, 74517, 92267, 176772, 160389, 199289, 234123, 209548, 184973, 45711, 86674, 45715, 217748, 45717, 144022, 86679, 184986, 127644, 201373, 70580, 29346, 239389, 4773, 21159, 168616, 167028, 193194, 217776, 119475, 185012, 242358, 220617, 21176, 111290, 119583, 193212, 24010, 160447, 127776, 94914, 37572, 227446, 103113, 239735, 53971, 209620, 185045, 155517, 167376, 78562, 13027, 135908, 187938, 135910, 45799, 4842, 29419, 163762, 204242, 79997, 54000, 163558, 103154, 135925, 4856, 135930, 152315, 111361, 13064, 4873, 85463, 45836, 29454, 106144, 201488, 13074, 111379, 13076, 4886, 160535, 21272, 95001, 78724, 37660, 45855, 37664, 226082, 144163, 103206, 21287, 29480, 54058, 13100, 45871, 190600, 234290, 172851, 226100, 78645, 86838, 37688, 152379, 95029, 78656, 3552, 13122, 142206, 13126, 21321, 209741, 54095, 217936, 201553, 48611, 227938, 80885, 168792, 95065, 201562, 160603, 119647, 45922, 193382, 209768, 185194, 13163, 4974, 160625, 234354, 127860, 4981, 177015, 168827, 86909, 226174, 75454, 125646, 167403, 127876, 100502, 62273, 39396, 187886, 168854, 95127, 187265, 171503, 29598, 123717, 30875, 95046, 103334, 119719, 143651, 226218, 78765, 45998, 120989, 54192, 111540, 13238, 62391, 119737, 95164, 242622, 126453, 198816, 111556, 228854, 91005, 37832, 136138, 167415, 13260, 242638, 151032, 29651, 1260, 103382, 241145, 5080, 134378, 136154, 193503, 136160, 70627, 242660, 242662, 29630, 103402, 194581, 5101, 21486, 177135, 95218, 187707, 21494, 172023, 185337, 185338, 46077, 200192, 218114, 29699, 29701, 54278, 201735, 21513, 23684, 78860, 30893, 29716, 125102, 111449, 87064, 70681, 152602, 95260, 205658, 58682, 185381, 22705, 229309, 13354, 54316, 70277, 37941, 70710, 78903, 193596, 136254, 153781, 205220, 78915, 201797, 230241, 103501, 62547, 201813, 210008, 218203, 152669, 87134, 169056, 193633, 13411, 111716, 152677, 78951, 146658, 152684, 13421, 5233, 218228, 21621, 29816, 144508, 226430, 185473, 90987, 44566, 29830, 218247, 87176, 13449, 177290, 111757, 5264, 193681, 169107, 75736, 70805, 185494, 144536, 186564, 87194, 107379, 201885, 144544, 169122, 53914, 152346, 242546, 29870, 119984, 145608, 103603, 177332, 215129, 79031, 120877, 57188, 220312, 128189, 160958, 45941, 120000, 103617, 46275, 70852, 22855, 38087, 242889, 95434, 38091, 111821, 13519, 79057, 155171, 103637, 201943, 218330, 13531, 62687, 242913, 185570, 154300, 210149, 120041, 144620, 152813, 210158, 5359, 46320, 242682, 95475, 13556, 186563, 227875, 103675, 38140, 177405, 63701, 136453, 62726, 54535, 226568, 79114, 58242, 26912, 218384, 202005, 21783, 133862, 5401, 183855, 120092, 5405, 29573, 13601, 62755, 79140, 70951, 152877, 234799, 210227, 38199, 62776, 87354, 136508, 152893, 49573, 152895, 234817, 185668, 210245, 183491, 193864, 95561, 62794, 24119, 21837, 5454, 193872, 161106, 185683, 169302, 177495, 111960, 92388, 71004, 106042, 161120, 5473, 142907, 128356, 51430, 120166, 30055, 60740, 136555, 161959, 218485, 30073, 161147, 80106, 54656, 161153, 5506, 210307, 136580, 87443, 142849, 177557, 208332, 177561, 218522, 162260, 79264, 177570, 164763, 103844, 71079, 161192, 21929, 234923, 136620, 125170, 5550, 153008, 153009, 112050, 178419, 161204, 54710, 79287, 71097, 71099, 5565, 95679, 87488, 95681, 201226, 62915, 193988, 46533, 38344, 218569, 128458, 196173, 121080, 185810, 38355, 13780, 21974, 157945, 13784, 62939, 239962, 79325, 218590, 30176, 44624, 128482, 120291, 194020, 169445, 136684, 79341, 79342, 46576, 134739, 231678, 103926, 47392, 13819, 120317, 216407, 159317, 211200, 210435, 111210, 136711, 13833, 62988, 62989, 163039, 87567, 226833, 87570, 243219, 50380, 120341, 218650, 144924, 243231, 10827, 153124, 243237, 169510, 128551, 5675, 128559, 226864, 137480, 17331, 235060, 112905, 6736, 144953, 187999, 6410, 5694, 241462, 13889, 128578, 13891, 21430, 13894, 13902, 75980, 188003, 236266, 22101, 243286, 172985, 161368, 5721, 30299, 226908, 226909, 87647, 71267, 218724, 97894, 63079, 30312, 46698, 13931, 79468, 223506, 202353, 153203, 128628, 5054, 30326, 226936, 79485, 30335, 161410, 153221, 13958, 5767, 71304, 71305, 135154, 194195, 104084, 38553, 46748, 112285, 5790, 115653, 112289, 73471, 215691, 186028, 112301, 87726, 136879, 14001, 71346, 40563, 71349, 5814, 5815, 120504, 22201, 91082, 120510, 30399, 46784, 5825, 186054, 205879, 104136, 46793, 14026, 194251, 121122, 210638, 95954, 5843, 70606, 38614, 145111, 102488, 235225, 227034, 5851, 202460, 136925, 55006, 46815, 22242, 107756, 243517, 54225, 186088, 183932, 145130, 55019, 218860, 202479, 30448, 5873, 104178, 37843, 161524, 161525, 109480, 76073, 24191, 194300, 161534, 62421, 210689, 96002, 30468, 120582, 202503, 235272, 210697, 30474, 210699, 112396, 5901, 46863, 59663, 243473, 5906, 108715, 243477, 79639, 14104, 237188, 203147, 5917, 177951, 96036, 11910, 202534, 124586, 186152, 96042, 236427, 137009, 63282, 104243, 169780, 79669, 38710, 235322, 153403, 227132, 36490, 118040, 137027, 170960, 210757, 71496, 223880, 30539, 30543, 55120, 128849, 96084, 89742, 16461, 137048, 198239, 22363, 14172, 96570, 96094, 5983, 104288, 32400, 112482, 239931, 218982, 243560, 30569, 55146, 96107, 145260, 5997, 178493, 140264, 79731, 243573, 104311, 63355, 14206, 92480, 153474, 136171, 46980, 46981, 210824, 161673, 210826, 204439, 120716, 235985, 6030, 13188, 120721, 152088, 46997, 239182, 93849, 96152, 112537, 6042, 96155, 96158, 235845, 63392, 11931, 47012, 87978, 22443, 227244, 169903, 6064, 178504, 169906, 53342, 87992, 104378, 63419, 137148, 14269, 79806, 186304, 22465, 235458, 186307, 37878, 202694, 40609, 219080, 39244, 153546, 104396, 6094, 22479, 186326, 242681, 22490, 14299, 153564, 219101, 153567, 55267, 210917, 205820, 63466, 47083, 63469, 235502, 30703, 38897, 22514, 88053, 100915, 190804, 6138, 63483, 186365, 30718, 161793, 47106, 137220, 112649, 6155, 22540, 104461, 243726, 63504, 214250, 70659, 71700, 63509, 215385, 22552, 22555, 55324, 202781, 143689, 137247, 243745, 161827, 104485, 88105, 181879, 170028, 186413, 6190, 79922, 170037, 119817, 235577, 146145, 170046, 183989, 145473, 194626, 92513, 104520, 129098, 179425, 202828, 63565, 219797, 202835, 219220, 202837, 161878, 96343, 22617, 88154, 216524, 6237, 96351, 112737, 96355, 63588, 145512, 6249, 235626, 208, 145518, 139487, 158056, 243826, 72607, 39030, 202871, 222228, 14459, 14461, 177173, 71808, 112769, 14466, 202884, 6283, 137356, 91160, 145555, 231790, 96406, 80023, 214071, 96410, 202907, 211101, 99825, 211107, 20123, 161957, 108913, 148508, 170155, 177246, 14509, 63663, 186545, 22709, 235706, 211131, 88252, 161981, 2393, 235712, 96449, 137411, 137412, 63862, 112840, 32945, 43196, 227531, 170188, 39120, 55506, 178387, 63700, 145621, 30937, 125685, 138959, 243935, 227552, 163536, 22756, 179703, 211177, 112874, 96491, 243950, 170223, 222248, 30962, 145651, 71925, 240635, 112888, 30970, 30972, 164906, 71511, 178560, 145666, 203012, 219397, 63751, 47368, 1068, 211210, 137485, 80142, 47376, 224168, 112916, 22806, 6427, 178464, 129314, 50889, 22823, 235816, 178476, 88365, 112947, 80180, 6456, 31033, 47418, 107573, 72074, 14655, 211264, 149899, 145732, 145733, 80199, 22856, 227724, 31051, 72012, 63823, 6483, 203095, 94216, 112987, 227676, 126777, 47458, 121188, 80229, 212703, 63849, 145770, 39275, 186736, 137586, 121204, 177214, 88438, 22903, 153977, 88442, 222262, 232355, 153982, 76181, 129408, 63230, 137604, 93932, 178570, 113035, 121228, 22927, 55697, 178580, 47509, 63895, 39321, 162202, 72091, 145821, 168525, 104863, 235937, 80291, 186788, 80294, 24305, 31144, 170409, 88492, 31149, 14767, 121265, 80306, 203188, 129465, 6587, 189493, 77557, 190880, 96707, 121287, 186824, 6601, 203210, 80333, 22992, 184056, 203218, 68003, 22996, 80341, 137687, 127064, 55716, 14810, 88540, 80349, 235998, 14817, 129507, 203236, 145830, 63975, 75839, 118524, 80295, 31212, 169346, 88559, 6641, 14834, 88563, 40702, 55798, 104873, 149706, 80377, 14843, 96764, 236030, 23039, 156758, 186887, 113160, 170505, 170506, 145932, 145837, 170513, 47634, 14868, 113173, 80406, 219672, 6684, 236062, 6689, 234587, 205489, 104998, 88615, 121384, 33884, 106247, 96812, 203186, 70749, 171784, 237448, 105012, 186933, 113076, 80442, 156767, 6719, 72257, 47682, 143175, 240054, 113222, 129610, 6731, 6732, 129614, 102157, 186960, 227921, 37987, 105044, 23126, 154199, 212722, 170587, 186972, 6749, 137824, 146017, 47714, 39523, 88678, 31336, 146025, 72299, 195180, 227949, 61874, 162416, 195185, 222543, 23155, 178804, 186998, 121464, 87485, 105082, 39548, 231872, 162435, 170628, 214971, 64135, 113288, 64138, 233239, 121484, 162445, 236174, 203408, 6801, 39571, 170645, 39574, 129688, 71150, 219802, 57114, 39588, 96792, 47783, 23212, 236205, 96943, 88753, 129714, 88755, 6836, 32542, 29812, 126751, 146108, 218229, 31424, 39619, 77971, 31432, 6859, 20258, 56014, 129744, 47825, 195282, 162515, 214137, 80602, 113373, 91611, 146143, 147620, 47568, 123288, 159526, 219879, 187112, 31466, 236269, 195310, 235987, 51240, 154360, 137684, 23290, 121595, 129789, 88830, 23295, 168297, 203522, 39683, 162564, 127929, 31494, 170759, 39688, 72457, 6922, 70881, 215183, 80653, 31502, 72463, 73609, 39699, 162581, 72153, 154392, 146201, 225071, 6940, 105245, 231005, 25733, 116087, 174812, 187173, 228135, 10716, 31530, 138028, 56110, 178653, 39728, 191725, 64308, 5257, 72504, 203577, 154426, 56123, 23357, 97086, 61237, 203585, 6979, 154437, 88902, 219975, 31567, 187216, 80721, 203606, 77625, 31576, 31577, 203159, 113500, 146269, 51685, 23392, 56163, 138084, 113196, 59879, 187245, 220014, 154480, 72562, 9363, 129908, 113525, 170871, 15224, 156820, 88955, 211836, 15229, 146305, 7043, 23428, 170885, 88966, 138121, 146314, 146315, 52257, 234055, 190957, 203664, 72594, 170899, 192001, 108068, 48022, 7063, 23450, 59887, 90799, 56222, 56223, 170912, 211874, 162723, 23465, 106311, 129522, 146351, 56240, 183273, 121781, 31671, 80825, 56252, 73316, 137717, 129985, 80834, 7107, 226646, 43065, 170952, 7116, 23501, 56270, 123235, 130001, 56274, 220115, 56276, 66796, 97239, 154585, 113626, 64475, 162783, 195552, 97249, 97252, 146406, 155451, 140455, 7149, 195567, 15344, 128173, 64498, 31731, 14846, 74435, 162807, 64504, 230820, 105469, 27136, 64514, 187395, 130053, 179206, 179209, 23562, 48139, 211980, 121870, 50349, 183029, 97300, 162839, 113690, 56347, 56349, 105502, 220191, 80928, 121889, 89122, 48164, 15399, 48168, 15403, 89132, 173234, 121435, 39983, 170504, 171060, 31797, 186889, 105528, 121913, 48187, 195646, 230581, 74408, 80961, 23618, 236613, 113736, 240140, 185527, 146695, 103353, 97363, 23636, 84494, 7257, 138330, 105564, 6829, 110437, 146095, 212067, 228452, 212071, 236648, 31850, 15467, 31855, 162928, 113777, 89204, 242530, 8426, 89210, 107711, 81020, 228289, 89219, 81028, 115905, 89224, 3948, 228491, 48269, 113806, 122001, 7314, 48276, 57198, 84505, 15512, 118904, 146589, 48286, 81058, 2699, 154792, 64681, 68167, 105643, 212140, 56495, 203952, 171186, 203956, 23733, 195769, 163002, 236732, 228546, 185547, 48325, 7366, 89287, 56520, 31945, 236746, 195787, 64721, 186915, 236760, 130363, 56538, 15579, 146652, 225146, 179422, 48351, 143184, 154849, 86957, 103633, 71845, 56558, 99505, 214953, 130298, 89341, 187649, 171268, 179461, 207053, 105735, 35372, 105738, 103639, 82355, 72974, 113935, 236818, 7447, 192388, 228636, 130333, 56606, 56608, 7457, 146723, 188050, 7463, 15657, 130346, 126855, 163116, 217787, 179502, 187695, 196488, 97586, 171315, 64820, 56629, 151433, 81208, 187705, 23867, 146748, 195903, 191197, 216293, 228677, 89414, 214241, 56649, 23882, 81227, 128226, 171342, 179535, 169187, 180110, 15702, 130392, 15705, 97626, 130395, 2618, 165093, 126003, 105826, 40293, 191471, 23912, 146795, 179565, 51773, 243916, 100926, 122237, 122240, 187777, 163205, 212146, 68161, 204168, 220553, 212362, 238118, 155022, 193773, 73105, 48531, 130453, 48535, 163227, 187805, 187806, 64927, 87280, 40354, 135067, 64932, 51782, 212390, 138666, 109127, 155053, 155054, 20381, 32177, 32583, 9255, 40378, 105919, 122305, 170197, 7619, 130500, 40391, 81353, 146890, 40395, 40397, 59981, 114128, 148728, 73170, 196515, 179745, 237014, 242937, 228825, 40411, 163293, 15839, 199248, 187874, 81379, 212453, 97767, 204265, 220650, 122348, 56814, 48623, 81392, 40433, 24050, 89455, 114164, 48629, 220662, 184233, 204280, 52084, 204282, 218367, 171517, 40453, 130988, 48650, 6743, 138764, 32269, 171949, 73233, 56850, 155155, 7700, 65045, 122391, 89625, 40475, 97820, 65054, 15903, 146977, 24098, 40483, 208817, 145650, 118099, 193799, 97837, 10845, 193800, 32306, 56883, 153245, 40503, 235843, 7738, 56891, 171580, 106045, 229301, 224485, 32324, 220741, 40518, 32327, 78001, 40522, 204363, 15949, 144653, 65105, 137827, 32343, 100965, 171618, 159675, 154381, 158200, 40550, 196200, 138857, 75026, 122478, 212925, 204400, 48754, 220787, 181107, 215657, 190581, 80185, 204415, 183843, 81540, 237189, 212617, 168769, 151227, 7822, 138895, 7824, 115992, 122514, 32407, 220824, 188059, 216258, 36805, 24224, 229025, 24226, 138915, 56996, 138920, 163498, 65195, 212652, 188079, 48817, 98249, 229048, 55924, 73406, 182901, 204480, 8072, 221332, 32454, 97991, 223863, 138956, 48847, 106192, 32466, 60025, 239493, 40665, 114394, 53199, 204510, 179935, 114400, 237282, 16099, 141158, 6810, 147176, 98026, 196332, 114415, 65265, 147186, 212723, 237300, 55093, 130806, 73464, 229115, 7932, 48894, 81877, 114433, 89861, 24327, 114440, 171786, 40720, 55939, 148782, 212759, 40728, 129668, 122650, 155422, 132788, 48930, 32550, 190122, 212780, 212781, 170482, 73526, 40759, 155450, 73531, 114493, 212799, 106306, 232075, 48964, 98119, 106316, 147278, 196431, 122704, 212817, 81749, 155478, 223676, 8028, 132410, 24415, 73568, 131587, 40804, 32614, 204647, 46396, 49002, 98155, 180076, 16238, 24433, 105107, 130932, 40821, 96833, 243007, 171901, 40831, 229249, 229355, 16260, 113302, 221062, 122760, 69612, 73611, 155534, 40850, 221075, 147348, 65430, 40855, 196591, 81820, 23194, 8095, 241648, 191131, 90021, 40945, 119373, 24492, 98221, 98223, 106418, 118771, 186035, 204726, 16311, 237497, 229308, 180157, 131006, 163776, 196547, 212932, 131062, 221126, 182945, 16329, 143351, 24525, 40910, 16339, 189855, 49109, 73687, 137892, 122843, 16348, 171997, 73696, 171579, 221155, 212964, 98277, 221158, 41462, 180203, 89199, 106480, 98289, 108294, 66899, 188405, 8182, 106487, 106495, 180220, 229375]

#X_test=scaler.transform(X_test)
Y_train=Y_train.flatten()
print(set(Y_train))

dic_labels = {'type5':4, 'type4':3, 'type1':0, 'type3':2, 'type2':1}

count = [0,0,0,0,0]
for j in xrange(len(Y_train)):
    Y_train[j]=dic_labels[Y_train[j]]
    count[int(Y_train[j])]+=1

print(count)

X_train, Y_train = shuffle(X_train,Y_train)

X_valid=X_train[250000:]
Y_valid=Y_train[250000:]
X_train=X_train[:250000]
Y_train=Y_train[:250000]
Y_valid_bin = np_utils.to_categorical(Y_valid, nb_classes)

print(set(Y_train))
#print(count)

print(X_train.shape, 'train samples')
print(Y_train.shape)

#print(Y_test.shape)
outliers_fraction = 0.175
clusters_separation = [0, 1, 2]
class_weight={'0':20,'1':5,'2':500,'3':10000,'4':30000}

classifiers = {"Random Forest": svm.LinearSVC(dual=False,class_weight=class_weight),'Adaboost':AdaBoostClassifier(DecisionTreeClassifier(max_depth=32),n_estimators=500)}

for i, (clf_name, clf) in enumerate(classifiers.items()):
    print('Checking out',clf_name)
    clf.fit(X_train,Y_train)
    ans = clf.predict(X_test)
    y_pred = clf.decision_function(X_test)
    print(ans.shape)
    print(y_pred.shape)
    threshold = []
    for j in xrange(y_pred.shape[1]):
        threshold.append(stats.scoreatpercentile(y_pred[:,j],100 * outliers_fraction))
    #print(threshold)
    for j in xrange(y_pred.shape[0]):
        for k in xrange(y_pred.shape[1]):
            if(ans[j] == 4 or y_pred[j][k] < threshold[k]):
                red_stared_idx.append(j)
    print('Finished! Checking out the other one!')
# convert class vectors to binary class matrices
class_weight={'0':20,'1':5,'2':500,'3':10000,'4':30000}
clf = RandomForestClassifier(max_depth=32, n_estimators=500, n_jobs=8, class_weight=class_weight)
clf.fit(X_train, Y_train)

#parameters = {'kernel':(['linear']), 'C':[10], 'gamma':[0.1]}
#clf = svm.LinearSVC(dual=False,class_weight=class_weight)
#clf = grid_search.GridSearchCV(clf, parameters)
clf.fit(X_train, Y_train)
# score = clf.score(X_valid, Y_valid)
# #print(score)
#valid_preds = clf.predict(X_valid)
#recall = metrics.recall_score(valid_preds,Y_valid,average=None)
#print(recall)
#precision = metrics.precision_score(valid_preds,Y_valid, average=None)
#print(precision)
##minmax_scale = preprocessing.MinMaxScaler(feature_range=(-0.5, 0.5))
##valid_preds = minmax_scale.fit_transform(valid_preds)
#
#valid_preds = valid_preds[:,1]
#
##for i in xrange(19962):
##  valid_preds[i] = valid_preds[i] + 0.5
#
#Y_valid=Y_valid_bin[:,1]
#
#Y_valid=np.array(Y_valid)
#print(Y_valid.shape)
##valid_preds = preprocessing.scale(valid_preds)
#roc = metrics.roc_auc_score(Y_valid, valid_preds)
#print("ROC:", roc)
#print('Done!')
#
#
print('Done!')
#
print('Generating Submission...')

pred = clf.predict(X_test)
print(pred.shape)

outfile = open('submission_0.175.txt', 'w+')
labels=['type1','type2','type3','type4','type5']
for i in xrange(pred.shape[0]):
    if i not in red_stared_idx:
        outfile.write('%s\n' % (labels[int(pred[i])]))
    else:
        outfile.write('type5\n')
outfile.close()
print('Completed!')
#h5f=h5py.File('data_test.h5','r+')
#X_test=h5f['dataset'][:]
#h5f.close()
#X_test=preprocessing.scale(X_test)
#h5f=h5py.File('id.h5','r+')
#idval=h5f['dataset'][:]
#h5f.close()
#
#outfile = open('submission.txt', 'w+')
#outfile.write('ID,target\n')
#
#pred = clf.predict_proba(X_test)
#
#minmax_scale = preprocessing.MinMaxScaler(feature_range=(-0.5, 0.5))
#pred = minmax_scale.fit_transform(pred)
#
#pred = pred[:,1]
#
#for i in xrange(idval.shape[0]):
#   valid_preds[i] = valid_preds[i] + 0.5
#
#for i in xrange(idval.shape[0]):
#   if i%10000==0:
#       print(i)
#   outfile.write('%s,%s\n' % (str(idval[i]), str(pred[i])))
#outfile.close()